Create Table Books (
BookID INTEGER PRIMARY KEY,
Title TEXT(255),
Author TEXT(255),
PublicationYear INT, 
Price REAL,
PRIMARY KEY (BookID) );
INSERT INTO Books (BookID, Title, Author, PublicationYear, Price) VALUES (1, 'The Lord of the Rings', 'J.R.R. Tolkien', 1954, 20.99);
INSERT INTO Books (BookID, Title, Author, PublicationYear, Price) VALUES (2, 'Dune', 'Frank Herbert', 1965, 15.99);
INSERT INTO Books (BookID, Title, Author, PublicationYear, Price) VALUES (3, 'Jurassic Park', 'Michael Crichton', 1990, 12.99);
INSERT INTO Books (BookID, Title, Author, PublicationYear, Price) VALUES (4, 'Atomic Habits', 'James Clear', 2018, 18.99);
INSERT INTO Books (BookID, Title, Author, PublicationYear, Price) VALUES (5, 'How to Win Friends and Influence People', 'Dale Carnegie', 1936, 10.99);
SELECT * FROM Books;
SELECT * FROM Books WHERE PublicationYear > 2000;
SELECT * FROM Books WHERE Author = 'J.R.R. Tolkien';
UPDATE Books SET Price = 17.99 WHERE Title = 'Dune';
DELETE FROM Books WHERE Title = 'How to Win Friends and Influence People';
SELECT * FROM Books;

CREATE TABLE Sales (
    SaleID INTEGER PRIMARY KEY AUTOINCREMENT,
    BookID INTEGER,
    SaleDate DATE,
    Quantity INTEGER,
    TotalPrice REAL,
    FOREIGN KEY (BookID) REFERENCES Books(BookID)
);

INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (1, '2024-08-20', 2, 41.98);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (2, '2024-08-21', 1, 15.99);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (3, '2024-08-22', 3, 38.97);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (4, '2024-08-23', 1, 18.99);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (5, '2024-08-24', 4, 43.96);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (1, '2024-08-25', 1, 20.99);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (2, '2024-08-26', 2, 31.98);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (3, '2024-08-27', 1, 12.99);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (4, '2024-08-28', 2, 37.98);
INSERT INTO Sales (BookID, SaleDate, Quantity, TotalPrice) VALUES (5, '2024-08-29', 3, 32.97);

SELECT DISTINCT Books.*
FROM Books
JOIN Sales ON Books.BookID = Sales.BookID;

SELECT Books.Title, SUM(Sales.TotalPrice) AS TotalSales
FROM Books
JOIN Sales ON Books.BookID = Sales.BookID
GROUP BY Books.Title;

SELECT * 
FROM Books
WHERE BookID NOT IN (SELECT DISTINCT BookID FROM Sales);

SELECT Books.Title, SUM(Sales.TotalPrice) AS TotalSales
FROM Books
JOIN Sales ON Books.BookID = Sales.BookID
GROUP BY Books.Title
ORDER BY TotalSales DESC
LIMIT 1;

SELECT Books.Author, SUM(Sales.TotalPrice) AS TotalSales
FROM Books
JOIN Sales ON Books.BookID = Sales.BookID
GROUP BY Books.Author;

UPDATE Sales
SET Quantity = 5, TotalPrice = 5 * (SELECT Price FROM Books WHERE BookID = 1)
WHERE SaleID = 1;

DELETE FROM Sales
WHERE SaleID = 2;

UPDATE Books
SET Price = Price * 0.9
WHERE BookID IN (
    SELECT BookID
    FROM Sales
    GROUP BY BookID
    HAVING SUM(TotalPrice) < 50
);